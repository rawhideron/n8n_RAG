apiVersion: v1
kind: ConfigMap
metadata:
  name: n8n-config
  namespace: google-rag
  labels:
    app: n8n
data:
  # Database
  DB_TYPE: "postgresdb"
  DB_POSTGRESDB_HOST: "postgres"
  DB_POSTGRESDB_PORT: "5432"

  # n8n behaviour
  N8N_DIAGNOSTICS_ENABLED: "false"
  N8N_PERSONALIZATION_ENABLED: "false"
  N8N_RUNNERS_ENABLED: "true"
  N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS: "true"
  N8N_DEFAULT_BINARY_DATA_MODE: "filesystem"

  # Network / URL â€” n8n is exposed at /n8n/ via the ingress
  N8N_HOST: "rawhideron.duckdns.org"
  N8N_PORT: "5678"
  N8N_PROTOCOL: "https"
  N8N_PATH: "/n8n/"
  WEBHOOK_URL: "https://rawhideron.duckdns.org/n8n/"

  # Cookies must be Secure over HTTPS
  N8N_SECURE_COOKIE: "true"

  # Request timeout: 30 minutes (for long-running RAG workflows)
  N8N_REQUEST_TIMEOUT: "1800000"

  # Ollama service name within the cluster
  OLLAMA_HOST: "ollama:11434"

  # Trust the nginx ingress proxy
  N8N_TRUST_ALL_PROXIES: "true"
